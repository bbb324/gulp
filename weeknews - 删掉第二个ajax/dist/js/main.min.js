function draw1(){var e,a=0;$.ajax({type:"GET",url:"src/js/template.json",data:"json",success:function(n){console.log(n.eachDayPay[0]),e=n.eachDayPay[0];for(var t=0;t<n.eachDayPay.length;t++)n.eachDayPay[t]>e&&(e=n.eachDayPay[t]),a+=n.eachDayPay[t];json_fill(n),draw_average(n.eachDayPay,e,a),stars(n.ratingStart),draw2(n.eachDayPay,a),draw3(n,a/7,n.eachDayPay.indexOf(e))},error:function(){console.log("wrong")}})}function json_fill(e){var a=e.topPayDay,n=$(".weekday")[a],t=$(".day span");switch(n.classList.add("today"),a){case 0:n.innerHTML="一",t[0].innerHTML="周一";break;case 1:n.innerHTML="二",t[0].innerHTML="周二";break;case 2:n.innerHTML="三",t[0].innerHTML="周三";break;case 3:n.innerHTML="四",t[0].innerHTML="周四";break;case 4:n.innerHTML="五",t[0].innerHTML="周五";break;case 5:n.innerHTML="六",t[0].innerHTML="周六";break;case 6:n.innerHTML="七",t[0].innerHTML="周七"}$(".user_name")[0].innerHTML=e.name,$(".date")[0].innerHTML=e.cycleRange+"周报",$(".rank span")[0].innerHTML=e.assetPecentage,$(".comment")[0].innerHTML=e.ratingBadgeDescription,$(".title span")[0].innerHTML="("+e.currencyName+")",$(".value")[0].innerHTML=e.weekPay,$(".income span")[0].innerHTML=e.weekIncome,$(".daily_average_conclude span")[0].innerHTML=e.averagePay;for(var r=0;r<e.topPayList.length;r++)$(".text")[r].innerHTML=e.topPayList[r].payName;var o=e.payComparePercent.substr(1,e.payComparePercent.length-1),i=e.payComparePercent.substr(0,1);"+"==i?$(".triangle")[0].classList.add("triangle_up"):"-"==i&&$(".triangle")[0].classList.add("triangle_down"),$(".percent")[0].innerHTML=o}function draw_average(e,a,n){var t=document.getElementById("daily_average"),r=t.getContext("2d"),o=parseFloat(window.innerWidth/320).toFixed(2);t.style.width=100*o+"px",t.style.height=50*o+"px";var i,l=[],s=0;r.beginPath(),r.fillStyle="#e5e6e9";for(var c=0;c<e.length;c++)l[s]=parseInt(e[c]/a*100),s++;for(c=0;c<e.length;c++)r.fillRect(22+9*c,25-l[c]/4,4,l[c]/4);i=parseInt(n/7)/a,r.moveTo(15,25-25*i),r.lineTo(85,25-25*i),r.strokeStyle="#14ba89",r.lineWidth=2,r.stroke(),r.closePath()}function stars(e){var a=0,n=0;a=e%1,n=e-a;for(var t=0;n>=t;t++)t==n?$(".star")[t].style.backgroundPosition="0 -1.7rem":$(".star")[t].style.backgroundPosition="0 -0.85rem"}function draw2(e,a){for(var n=[],t=[],r=0,o=e.sort(sortNumber).length-1;o>=e.sort(sortNumber).length-3;o--)n[r]=e[o],t[r]=Math.round(e[o]/a*100),r++;$(".amount")[1].innerHTML=t[0]+"<span>%</span>",$(".amount")[0].innerHTML=t[2]+"<span>%</span>",$(".amount")[2].innerHTML=t[1]+"<span>%</span>"}function sortNumber(e,a){return e-a}function draw3(e,a){var n=document.getElementById("diagram"),t=n.getContext("2d"),r=0,o=0,i=parseInt(a),l=parseFloat(window.innerWidth/320).toFixed(2);n.style.width=320*l+"px",n.style.height=150*l+"px",t.beginPath(),t.translate(.5,.5),t.strokeStyle="#c2c5ca",t.lineWidth=1,t.moveTo(35,10.5),t.lineTo(35,125),t.stroke(),t.beginPath(),t.strokeStyle="#394042",t.moveTo(25,125),t.lineTo(280,125),t.stroke(),$.ajax({url:"src/js/template.json",type:"GET",data:"json",success:function(e){r=e.eachDayPay[0];for(var a=0;a<e.eachDayPay.length;a++)e.eachDayPay[a]>r&&(r=e.eachDayPay[a],o=e.eachDayPay.indexOf(r));var n=getY_coordinate(r);for(console.log(n),a=0;a<2*n.length;a++)t.beginPath(),0===a?t.strokeStyle="#394042":t.strokeStyle="#c2c5ca",t.moveTo(25,125-19*a),t.lineTo(35,125-19*a),t.stroke();for(a=n.length-1;a>=0;a--)a==n.length-1?t.fillText(n[a],18,38*a+14):n[a]>=1e3?t.fillText(n[a]/1e3+"k",23,38*a+14):t.fillText(n[a],23,38*a+14),t.textAlign="end";var l=["周一","周二","周三","周四","周五","周六","周日"];for(t.font="0.6rem Times New Roman",a=0;a<e.eachDayPay.length;a++){if(a==o){var s=t.createLinearGradient(44+35*a,124.5,20,-1*(e.eachDayPay[a]/13.2));s.addColorStop("1.0","rgba(39,180,95,1)"),s.addColorStop("0.4","rgba(39,180,95,1)"),s.addColorStop("0","rgba(39,180,95,0.53)"),t.fillStyle=s,t.fillRect(48+32*a,124.5,16,-1*(114/r*e.eachDayPay[a]))}else t.fillStyle="#ced1d6",t.fillRect(48+32*a,124.5,16,-1*(114/r*e.eachDayPay[a]));t.stroke()}t.fillStyle="#394042";for(var a=0;a<l.length;a++)t.font="8px Arial",t.fillText(l[a],69+32*a,144);var c=114-parseInt(114/n[0]*i)+10.5;t.beginPath(),t.lineTo(35,c),t.lineTo(260,c),t.strokeStyle="rgba(58,99,117, 0.1)",t.lineWidth=1,t.stroke(),t.fillStyle="#37403d",t.beginPath(),t.moveTo(260,c),t.lineTo(267,c-4),t.lineTo(267,c+4),t.closePath(),t.fill(),t.font="8px Times New Roman",t.fillText("日均",295,c+4),t.stroke()},error:function(){console.log("read error")}})}function getY_coordinate(e){var a,n,t=e.toString().length;1==t?(n=e,a=1):(a=Math.pow(10,t-2),n=parseInt(e/a));for(var r=1;4>r;r++){if(n%3==0){n*=a;break}n+=1}var o=[];o[0]=0,o[3]=n;for(var i=0,l=n/3,r=1;l>=r;r++)if(o[i++]=n,n-=l,0==n){o[i++]=n;break}return o}!function(){draw1()}();